(()=>{"use strict";const e=window.React,t=(window.wp.plugins,window.wp.editPost,window.wp.blockEditor),a=window.wp.compose,s=window.wp.hooks,l=window.wp.element,n=window.wp.components,r=window.wp.data,o=window.wp.i18n,c=({classes:t,onRemove:a,onReorder:s})=>{const[n,r]=(0,l.useState)(null),o=(0,l.useRef)(null),c=e=>{o.current=null,r(null),e.currentTarget.classList.remove("is-dragging","dragging-active")},i=e=>(e.preventDefault(),e.dataTransfer.dropEffect="move",!1),d=e=>{e.currentTarget.classList.add("drag-over")},u=e=>{e.currentTarget.classList.remove("drag-over")};return(0,e.createElement)("div",{className:"lza-class-list"},t.map(((l,n)=>(0,e.createElement)("div",{key:l,className:"lza-class-button-wrapper",draggable:"true",onDragStart:e=>((e,t,a)=>{o.current=a,r(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t),e.currentTarget.classList.add("is-dragging"),setTimeout((()=>{e.currentTarget.classList.add("dragging-active")}),0)})(e,l,n),onDragEnd:c,onDragOver:i,onDrop:e=>((e,a)=>{e.preventDefault();const l=o.current;if(null===l||l===a)return;const n=[...t],[r]=n.splice(l,1);return n.splice(a,0,r),s(n),!1})(e,n),onDragEnter:d,onDragLeave:u},(0,e.createElement)("button",{type:"button",className:"class-button",onClick:()=>a(l),title:"Click to remove, drag to reorder"},l)))))},i=({clientId:t})=>{const[a,s]=(0,l.useState)(""),[i,d]=(0,l.useState)([]),[u,m]=(0,l.useState)(!1),[g,p]=(0,l.useState)(-1),{attributes:w,availableClasses:v}=(0,r.useSelect)((e=>{const{getBlockAttributes:a}=e("core/block-editor");return{attributes:a(t)||{},availableClasses:window.lzaClassManager?.availableClasses||[]}}),[t]),{updateBlockAttributes:E}=(0,r.useDispatch)("core/block-editor"),f=(w.className||"").split(" ").filter(Boolean),C=e=>{if(!e||f.includes(e))return;const a=[...f,e];E(t,{className:a.join(" ")}),s(""),m(!1)};return(0,e.createElement)(n.PanelBody,{title:(0,o.__)("LZA Class Manager"),initialOpen:!0},(0,e.createElement)("div",{className:"lza-class-manager"},(0,e.createElement)("div",{className:"lza-class-form"},(0,e.createElement)(n.TextControl,{label:(0,o.__)("Add Class(es)"),value:a,onChange:e=>{if(s(e),e){const t=v.filter((t=>t.toLowerCase().includes(e.toLowerCase())&&!f.includes(t)));d(t),m(t.length>0),p(-1)}else m(!1),p(-1)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),g>=0&&g<i.length?C(i[g]):a&&C(a)):"ArrowDown"===e.key&&u?(e.preventDefault(),p((e=>e<i.length-1?e+1:0))):"ArrowUp"===e.key&&u?(e.preventDefault(),p((e=>e>0?e-1:i.length-1))):"Escape"===e.key&&(e.preventDefault(),m(!1),p(-1))},placeholder:(0,o.__)("Enter class name and press Enter"),className:"lza-class-input",autoComplete:"off"})),u&&(0,e.createElement)("div",{className:"class-suggestions"},i.map(((t,a)=>(0,e.createElement)("div",{key:t,className:"class-suggestion-item "+(g===a?"is-selected":""),onClick:()=>C(t)},t)))),(0,e.createElement)("div",{className:"lza-applied-classes"},(0,e.createElement)(c,{classes:f,onRemove:e=>{const a=f.filter((t=>t!==e));E(t,{className:a.join(" ")})},onReorder:e=>{E(t,{className:e.join(" ")})}}))))},d=(0,a.createHigherOrderComponent)((a=>s=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a,{...s}),(0,e.createElement)(t.InspectorControls,null,(0,e.createElement)(i,{clientId:s.clientId})))),"withClassManagerPanel");(0,s.addFilter)("editor.BlockEdit","lza-class-manager/with-class-manager-panel",d)})();